"use strict";const e=require("../../common/vendor.js"),o=require("../../api/index.js");if(!Array){(e.resolveComponent("uv-checkbox")+e.resolveComponent("uv-image")+e.resolveComponent("uv-checkbox-group")+e.resolveComponent("uv-load-more")+e.resolveComponent("uv-button")+e.resolveComponent("uv-form-item")+e.resolveComponent("uv-form")+e.resolveComponent("my-drawer")+e.resolveComponent("my-confirm"))()}Math||((()=>"../../uni_modules/uv-checkbox/components/uv-checkbox/uv-checkbox.js")+(()=>"../../uni_modules/uv-image/components/uv-image/uv-image.js")+(()=>"../../uni_modules/uv-checkbox/components/uv-checkbox-group/uv-checkbox-group.js")+(()=>"../../uni_modules/uv-load-more/components/uv-load-more/uv-load-more.js")+(()=>"../../uni_modules/uv-button/components/uv-button/uv-button.js")+n+(()=>"../../uni_modules/uv-form/components/uv-form-item/uv-form-item.js")+(()=>"../../uni_modules/uv-form/components/uv-form/uv-form.js")+(()=>"../../components/my-drawer/my-drawer.js")+(()=>"../../components/my-confirm/my-confirm.js"))();const n=()=>"./components/CarNumber.js",a={__name:"carList",setup(n){const a=e.ref([]);e.ref();const r=e.ref(!1);function t(){r.value&&(a.value=[]),r.value=!r.value}e.ref();const c=e.ref();function l(){console.log("checkboxValue",a.value),0!==a.value.length&&c.value.confirm({title:"确定删除所选车辆？",content:"您的运单记录不会被影响",cancelText:"取消",confirmText:"删除",asyncClose:!0,async confirm(){try{await o.DelteUserCarno({ownerCarId:a.value.map((e=>e.Id)).join(",")}),e.index.showToast({title:"删除成功",icon:"none"}),c.value.close(),g()}catch{c.value.closeLoading()}}})}const u=e.ref(),s=e.ref(null),i=e.reactive({number:""}),m=e.ref({number:{validator:(e,o,n)=>{if(!o)return!1;const a=o.split(""),r=a.slice(0,7).every((e=>" "!==e)),t=a.slice(0,8).every((e=>" "!==e));return r||t},message:"请填写正确的车牌号"}});function v(e){e.show||(i.number="")}function p(){u.value.popup.open()}async function d(){if(await s.value.validate())try{e.index.showLoading({mask:!0});await o.CreateOwnerUserCarno({carno:i.number});u.value.popup.close(),g()}catch(n){e.index.showToast({title:n.data,icon:"none"})}finally{e.index.hideLoading()}}e.onLoad((()=>{g()}));const f=e.ref([]);async function g(){try{e.index.showLoading();const n=await o.GetOwnerCarMgr();console.log("res",n),f.value=n}finally{e.index.hideLoading()}}return e.onPullDownRefresh((async()=>{await g(),e.index.stopPullDownRefresh()})),(n,h)=>e.e({a:e.t(f.value.length),b:e.f(f.value,((n,a,t)=>e.e(r.value?{a:"c2a962ca-1-"+t+",c2a962ca-0",b:e.p({customStyle:{marginRight:"6px"},name:n})}:{c:e.t(n.Carno)},{d:"c2a962ca-2-"+t+",c2a962ca-0",e:e.o((a=>{return r=n,void c.value.confirm({title:"确定删除该车辆？",content:"您的运单记录不会被影响",cancelText:"取消",confirmText:"删除",asyncClose:!0,async confirm(){try{await o.DelteUserCarno({ownerCarId:r.Id}),e.index.showToast({title:"删除成功",icon:"none"}),c.value.close(),g()}catch{c.value.closeLoading()}}});var r}),n.Id),f:a<f.value.length-1?1:"",g:n.Id}))),c:r.value,d:e.p({duration:0,src:"/static/images/remove.png",width:"32rpx",height:"32rpx","custom-style":{marginRight:"8rpx"}}),e:e.o((e=>a.value=e)),f:e.p({shape:"circle",activeColor:"var(--red-color)",icon:"32rpx",modelValue:a.value}),g:e.p({status:"nomore",color:"#B0BECC"}),h:e.o(t),i:e.p({text:r.value?"完成":"管理",color:"var(--page-bg)",customTextStyle:{color:"var(--content-color)"}}),j:r.value},r.value?{k:e.o(l),l:e.p({text:"删除所选",color:0===a.value.length?"#C8D4DF":"var(--red-color)"})}:{m:e.o(p),n:e.p({text:"+ 添加车辆",color:"linear-gradient( 270deg, #31CE57 0%, #07B130 100%);"})},{o:e.o((e=>i.number=e)),p:e.p({modelValue:i.number}),q:e.p({labelPosition:"top",label:"车牌号码",prop:"number"}),r:e.sr(s,"c2a962ca-8,c2a962ca-7",{k:"form"}),s:e.p({errorType:"toast",model:i,rules:m.value,"label-width":"140rpx"}),t:e.o(d),v:e.p({text:"确认添加",color:"linear-gradient( 270deg, #31CE57 0%, #07B130 100%);"}),w:e.sr(u,"c2a962ca-7",{k:"myCarNumber"}),x:e.o(v),y:e.p({title:"添加车牌号码",height:480,closeable:!0}),z:e.sr(c,"c2a962ca-12",{k:"confirm"})})}};wx.createPage(a);
