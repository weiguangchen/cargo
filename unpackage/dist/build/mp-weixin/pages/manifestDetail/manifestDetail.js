"use strict";const e=require("../../common/vendor.js"),t=require("../../api/index.js");if(!Array){(e.resolveComponent("uv-navbar")+e.resolveComponent("uv-image")+e.resolveComponent("uv-line")+e.resolveComponent("my-price")+e.resolveComponent("uv-button")+e.resolveComponent("my-confirm"))()}Math||((()=>"../../uni_modules/uv-navbar/components/uv-navbar/uv-navbar.js")+(()=>"../../uni_modules/uv-image/components/uv-image/uv-image.js")+(()=>"../../uni_modules/uv-line/components/uv-line/uv-line.js")+(()=>"../../components/my-price/my-price.js")+(()=>"../../uni_modules/uv-button/components/uv-button/uv-button.js")+l+a+(()=>"../../components/my-confirm/my-confirm.js")+n)();const a=()=>"../billDetail/components/RemarkDrawer.js",l=()=>"../billDetail/components/MapDrawer.js",n=()=>"./components/CarnoDrawer.js",u={__name:"manifestDetail",setup(a){function l(){e.index.navigateBack()}const n=e.ref(),u=e.ref();e.onLoad((e=>{n.value=(null==e?void 0:e.assignId)??"",u.value=(null==e?void 0:e.supplyId)??"",i()}));const o=e.ref({});async function i(){try{const e=await t.GetAssignDetail({assignId:n.value,supplyId:u.value});o.value=e||{}}catch{}}const r=e.computed((()=>{var e,t;if(!o.value.CarType)return"";return((null==(t=null==(e=o.value)?void 0:e.CarType)?void 0:t.split(","))??[]).join(" + ")})),s=e.computed((()=>{var e,t;return o.value.Carno?(null==(t=null==(e=o.value)?void 0:e.Carno)?void 0:t.split(","))??[]:[]})),v=e.computed((()=>0===s.value.length?"":1===s.value.length?s.value[0]:s.value.length>1?`${s.value[0]} 等 ${s.value.length} 车`:void 0)),d=e.ref();function c(){s.value.length<=1||d.value.open(s.value)}const p=e.ref();function m(e){var t,a,l,n,u,i,r,s,v,d,c,m,g,S,h,x,y,f,E,C,b,w,T,L,M,U,j,k,R,A,D,I,N,O,$,B;const z={type:e,name:1===e?(null==(a=null==(t=o.value)?void 0:t.SupEnt)?void 0:a.SupplierName)??"":(null==(n=null==(l=o.value)?void 0:l.UnloadEnt)?void 0:n.PlaceName)??"",address:1===e?`${(null==(i=null==(u=o.value)?void 0:u.SupEnt)?void 0:i.Province)??""}${(null==(s=null==(r=o.value)?void 0:r.SupEnt)?void 0:s.City)??""}${(null==(d=null==(v=o.value)?void 0:v.SupEnt)?void 0:d.District)??""}${(null==(m=null==(c=o.value)?void 0:c.SupEnt)?void 0:m.Address)??""}`:`${(null==(S=null==(g=o.value)?void 0:g.UnloadEnt)?void 0:S.Province)??""}${(null==(x=null==(h=o.value)?void 0:h.UnloadEnt)?void 0:x.City)??""}${(null==(f=null==(y=o.value)?void 0:y.UnloadEnt)?void 0:f.District)??""}${(null==(C=null==(E=o.value)?void 0:E.UnloadEnt)?void 0:C.Address)??""}`,user:1===e?(null==(w=null==(b=o.value)?void 0:b.SupEnt)?void 0:w.Linker)??"":(null==(L=null==(T=o.value)?void 0:T.UnloadEnt)?void 0:L.NickName)??"",phone:1===e?(null==(U=null==(M=o.value)?void 0:M.SupEnt)?void 0:U.LinkerMobile)??"":(null==(k=null==(j=o.value)?void 0:j.UnloadEnt)?void 0:k.Mobile)??"",longitude:1===e?null==(A=null==(R=o.value)?void 0:R.SupEnt)?void 0:A.Logitude:null==(I=null==(D=o.value)?void 0:D.UnloadEnt)?void 0:I.Logitude,latitude:1===e?null==(O=null==(N=o.value)?void 0:N.SupEnt)?void 0:O.Latitude:null==(B=null==($=o.value)?void 0:$.UnloadEnt)?void 0:B.Latitude};p.value.open(z)}const g=e.ref();function S(){g.value.open({title:"派单备注",memo:o.value.Memo})}const h=e.ref();function x(){h.value.confirm({title:"确定完结货单？",content:"完结后将不再派发新的运单任务，当前进行中的运单任务不受影响",cancelText:"再想想",confirmText:"完结货单",asyncClose:!0,async confirm(){try{await t.SetAssignStatusChg({optType:"end",assignId:n.value,supplyId:u.value}),e.index.showToast({title:"操作成功",icon:"none"}),h.value.close(),i()}catch(a){e.index.showToast({icon:"none",title:a.data}),h.value.closeLoading()}}})}function y(){h.value.confirm({title:"确定暂停货单？",content:"暂停后将不再派发新的运单任务，后续可随时继续派单，当前进行中的运单任务不受影响",cancelText:"再想想",confirmText:"暂停货单",confirmBgColor:"var(--main-color)",asyncClose:!0,async confirm(){try{await t.SetAssignStatusChg({optType:"pause",assignId:n.value,supplyId:u.value}),e.index.showToast({title:"操作成功",icon:"none"}),h.value.close(),i()}catch(a){e.index.showToast({icon:"none",title:a.data}),h.value.closeLoading()}}})}function f(){h.value.confirm({title:"确定继续派单？",content:"将继续派发运单任务",cancelText:"再想想",confirmText:"继续派单",confirmBgColor:"var(--main-color)",asyncClose:!0,async confirm(){try{await t.ResetAssignStatusChg({assignId:n.value,supplyId:u.value}),e.index.showToast({title:"操作成功",icon:"none"}),h.value.close(),i()}catch(a){e.index.showToast({icon:"none",title:a.data}),h.value.closeLoading()}}})}return(t,a)=>e.e({a:e.o(l),b:e.p({placeholder:!0,bgColor:"var(--page-bg)"}),c:"1"===o.value.Status},(o.value.Status,{}),{d:"2"===o.value.Status},(o.value.Status,{}),{e:"3"===o.value.Status},(o.value.Status,{}),{f:"4"===o.value.Status},(o.value.Status,{}),{g:"5"===o.value.Status},(o.value.Status,{}),{h:["2","3","4"].includes(o.value.Status)},["2","3","4"].includes(o.value.Status)?e.e({i:"2"===o.value.Status},(o.value.Status,{}),{j:"3"===o.value.Status},(o.value.Status,{}),{k:"4"===o.value.Status},(o.value.Status,{})):{},{l:o.value.SupEnt},o.value.SupEnt?{m:e.t(o.value.SupEnt?o.value.SupEnt.SupplierName:""),n:e.t(o.value.SupEnt?o.value.SupEnt.Linker:""),o:e.t(o.value.SupEnt?o.value.SupEnt.LinkerMobile:""),p:e.o(((...e)=>t.selectAddress&&t.selectAddress(...e))),q:e.p({src:"/static/images/arrow.png",duration:0,width:"24rpx",height:"24rpx"}),r:e.o((e=>m(1)))}:{},{s:o.value.UnloadEnt},o.value.UnloadEnt?{t:e.t(o.value.UnloadEnt?o.value.UnloadEnt.PlaceName:""),v:e.t(o.value.UnloadEnt?o.value.UnloadEnt.NickName:""),w:e.t(o.value.UnloadEnt?o.value.UnloadEnt.Mobile:""),x:e.o(((...e)=>t.selectAddress&&t.selectAddress(...e))),y:e.p({src:"/static/images/arrow.png",duration:0,width:"24rpx",height:"24rpx"}),z:e.o((e=>m(2)))}:{},{A:e.f(o.value.MatList,((t,a,l)=>e.e({a:e.t(t.MaterialName),b:"0"===t.Limittype},"0"===t.Limittype?{c:e.t(t.Realweight)}:{},{d:"1"===t.Limittype},"1"===t.Limittype?{e:e.t(t.Realweight),f:e.t(t.EstimateWeight)}:{},{g:"2"===t.Limittype},"2"===t.Limittype?{h:e.t(t.Realtimes),i:e.t(t.EstimateTimes)}:{},{j:"b418e216-3-"+l,k:e.t(t.Realamount||0),l:a<o.value.MatList.length-1?1:"",m:t.Id}))),B:e.p({direction:"col",color:"#B0BECC",length:"24rpx",margin:"0 24rpx"}),C:e.f(100,((e,t,a)=>({}))),D:e.p({color:"var(--red-color)",price:o.value.RealCarAmount}),E:e.t(o.value.EstimateCarAmount),F:e.t(o.value.OwnerEnt?o.value.OwnerEnt.OwnerName:""),G:e.t(o.value.AssignCode),H:e.t(o.value.CreatorTime?e.unref(e.dayjs)(o.value.CreatorTime).format("YYYY-MM-DD HH:mm:ss"):""),I:o.value.StartTime},o.value.StartTime?{J:e.t(o.value.StartTime),K:o.value.EndTime?"":1}:{},{L:o.value.EndTime},o.value.EndTime?{M:e.t(o.value.EndTime)}:{},{N:e.t(r.value),O:o.value.Carno},o.value.Carno?e.e({P:e.t(v.value),Q:s.value.length>1},s.value.length>1?{R:e.p({src:"/static/images/arrow.png",width:"18rpx",height:"18rpx",duration:0,customStyle:{marginLeft:"2rpx"}})}:{},{S:e.o(c)}):{},{T:!!o.value.Memo},o.value.Memo?{U:e.p({src:"/static/images/arrow.png",width:"18rpx",height:"18rpx",duration:0,customStyle:{marginLeft:"2rpx"}}),V:e.o(S)}:{},{W:o.value.Orderno},o.value.Orderno?{X:e.t(o.value.Orderno)}:{},{Y:!!o.value.RelOnwayCount},o.value.RelOnwayCount?{Z:e.t(o.value.RelOnwayCount),aa:e.p({src:"/static/images/arrow.png",width:"18rpx",height:"18rpx",duration:0,customStyle:{marginLeft:"2rpx"}})}:{},{ab:["1","2","3","4"].includes(o.value.Status)},["1","2","3","4"].includes(o.value.Status)?e.e({ac:["1"].includes(o.value.Status)},["1"].includes(o.value.Status)?{ad:e.o(x),ae:e.p({text:"完结货单",color:"var(--page-bg)","custom-style":{height:"96rpx",borderRadius:"16rpx",fontSize:"30rpx",color:"var(--sub-color)"}}),af:e.o(y),ag:e.p({text:"暂停货单",color:"var(--page-bg)","custom-style":{height:"96rpx",borderRadius:"16rpx",fontSize:"30rpx",color:"var(--sub-color)"}})}:{},{ah:["2","3"].includes(o.value.Status)},["2","3"].includes(o.value.Status)?{ai:e.o(x),aj:e.p({text:"完结货单",color:"var(--page-bg)","custom-style":{height:"96rpx",borderRadius:"16rpx",fontSize:"30rpx",color:"var(--sub-color)"}}),ak:e.o(f),al:e.p({text:"继续派单",color:"linear-gradient( 270deg, #31CE57 0%, #07B130 100%)","custom-style":{height:"96rpx",borderRadius:"16rpx",fontSize:"30rpx"}})}:{},{am:["5"].includes(o.value.Status)},["5"].includes(o.value.Status)?{an:e.o(f),ao:e.p({text:"继续派单",color:"linear-gradient( 270deg, #31CE57 0%, #07B130 100%)","custom-style":{height:"96rpx",width:"100%",borderRadius:"16rpx",fontSize:"30rpx"}})}:{}):{},{ap:e.sr(p,"b418e216-13",{k:"mapModal"}),aq:e.sr(g,"b418e216-14",{k:"remarkModal"}),ar:e.sr(h,"b418e216-15",{k:"confirm"}),as:e.sr(d,"b418e216-16",{k:"carnoModal"})})}};wx.createPage(u);
