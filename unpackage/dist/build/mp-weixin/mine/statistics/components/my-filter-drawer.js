"use strict";const e=require("../../../common/vendor.js"),a=require("../../../api/index.js");if(!Array){(e.resolveComponent("uv-image")+e.resolveComponent("uv-col")+e.resolveComponent("uv-row")+e.resolveComponent("uv-button")+e.resolveComponent("my-drawer")+e.resolveComponent("uv-datetime-picker"))()}Math||((()=>"../../../uni_modules/uv-image/components/uv-image/uv-image.js")+(()=>"../../../uni_modules/uv-row/components/uv-col/uv-col.js")+(()=>"../../../uni_modules/uv-row/components/uv-row/uv-row.js")+l+t+(()=>"../../../uni_modules/uv-button/components/uv-button/uv-button.js")+(()=>"../../../components/my-drawer/my-drawer.js")+(()=>"../../../uni_modules/uv-datetime-picker/components/uv-datetime-picker/uv-datetime-picker.js"))();const t=()=>"./my-select.js",l=()=>"./my-datetime.js",o={__name:"my-filter-drawer",emits:["visible-change","change"],setup(t,{expose:l,emit:o}){const u=o;function n(e){u("visible-change",e)}const r=e.ref();function s(){r.value.popup.open(),async function(){try{const e=await a.GetOwnerSupplyList();d.value=e.map((e=>({value:e.Id,label:e.Fullname})))}catch{d.value=[]}}(),b(),async function(){try{const e=await a.GetUnloadPlaceList();x.value=e.map((e=>({value:e.Id,label:e.Placename})))}catch{x.value=[]}}(),async function(){try{const e=await a.GetOwnerUserCarList();C.value=e.map((e=>({value:e.Id,label:e.Carno})))}catch{C.value=[]}}(),M()}const v=e.ref("全部时间"),p=e.ref(!0);function i(a){v.value=a,"全部时间"===v.value&&(c.value=[],p.value=!0),"今天"===v.value&&(c.value=[e.dayjs().format("YYYY-MM-DD"),e.dayjs().format("YYYY-MM-DD")],p.value=!0),"昨天"===v.value&&(c.value=[e.dayjs().subtract(1,"day").format("YYYY-MM-DD"),e.dayjs().subtract(1,"day").format("YYYY-MM-DD")],p.value=!0),"本月"===v.value&&(c.value=[e.dayjs().startOf("month").format("YYYY-MM-DD"),e.dayjs().endOf("month").format("YYYY-MM-DD")],p.value=!0),"近7天"===v.value&&(c.value=[e.dayjs().subtract(7,"day").format("YYYY-MM-DD"),e.dayjs().format("YYYY-MM-DD")],p.value=!0),"自定义时间"===v.value&&(p.value=!1)}const c=e.ref([]);function m(e){console.log(e)}const d=e.ref([]);const f=e.ref("");function y(e){Y.value="",D.value="",b(),M()}function g(){e.index.showToast({title:"请先选择装货厂家",icon:"none"})}const h=e.ref([]);async function b(){try{const e=await a.GetOwnerMaterialsList({supplyId:f.value});h.value=e.map((e=>({value:e.MaterialId,label:e.MaterialName})))}catch{h.value=[]}}const Y=e.ref(""),x=e.ref([]);const w=e.ref(""),j=e.ref([]);async function M(){try{const e=await a.GetOwnerBySupply({supplyId:f.value});j.value=e.map((e=>({value:e.Id,label:e.Ownername})))}catch{j.value=[]}}const D=e.ref(""),C=e.ref([]);const I=e.ref(""),S=e.computed((()=>{const e={},[a,t]=c.value;return a&&(e.startTime=a),t&&(e.endTime=t),f.value&&(e.supplyId=f.value),Y.value&&(e.materialId=Y.value),w.value&&(e.unplaceId=w.value),D.value&&(e.ownerId=D.value),I.value&&(e.carno=I.value),console.log("formValues",S),e})),O=e.ref({}),k=e.computed((()=>Object.keys(O.value).some((e=>O.value[e]))));function V(){v.value="全部时间",p.value=!0,c.value=[],f.value="",Y.value="",w.value="",D.value="",I.value="",O.value=S.value,b(),u("change",{params:O.value,isFilter:k.value}),r.value.popup.close()}function _(){O.value=S.value,r.value.popup.close(),u("change",{params:O.value,isFilter:k.value})}return l({reset:V}),(a,t)=>e.e({a:k.value},k.value?{b:e.p({src:"/static/images/filter/filter-selected.png",width:"32rpx",height:"32rpx"})}:{c:e.p({src:"/static/images/filter/filter.png",width:"32rpx",height:"32rpx"})},{d:k.value?1:"",e:e.o(s),f:"全部时间"===v.value?1:"",g:e.o((e=>i("全部时间"))),h:e.p({span:"4"}),i:"今天"===v.value?1:"",j:e.o((e=>i("今天"))),k:e.p({span:"4"}),l:"昨天"===v.value?1:"",m:e.o((e=>i("昨天"))),n:e.p({span:"4"}),o:e.p({customStyle:"margin-bottom: 24rpx",gutter:"20rpx"}),p:"本月"===v.value?1:"",q:e.o((e=>i("本月"))),r:e.p({span:"4"}),s:"近7天"===v.value?1:"",t:e.o((e=>i("近7天"))),v:e.p({span:"4"}),w:"自定义时间"===v.value?1:"",x:e.o((e=>i("自定义时间"))),y:e.p({span:"4"}),z:e.p({customStyle:"margin-bottom: 24rpx",gutter:"20rpx"}),A:"自定义时间"===v.value},"自定义时间"===v.value?{B:e.o(m),C:e.o((e=>c.value=e)),D:e.p({disabled:p.value,modelValue:c.value})}:{},{E:e.o(y),F:e.o((e=>f.value=e)),G:e.p({options:d.value,title:"选择装货厂家",placeholder:"全部装货厂家",modelValue:f.value}),H:e.p({span:"6"}),I:e.o(g),J:e.o((e=>Y.value=e)),K:e.p({options:h.value,title:"选择物料",placeholder:"全部物料",disabled:!f.value,modelValue:Y.value}),L:e.p({span:"6"}),M:e.p({customStyle:"margin-bottom: 24rpx",gutter:"20rpx"}),N:e.o((e=>w.value=e)),O:e.p({options:x.value,title:"选择卸货地",placeholder:"全部卸货地",modelValue:w.value}),P:e.p({span:"12"}),Q:e.p({customStyle:"margin-bottom: 24rpx",gutter:"20rpx"}),R:e.o(g),S:e.o((e=>D.value=e)),T:e.p({options:j.value,title:"选择货主信息",placeholder:"全部货主信息",disabled:!f.value,modelValue:D.value}),U:e.p({span:"12"}),V:e.p({customStyle:"margin-bottom: 24rpx",gutter:"20rpx"}),W:e.o((e=>I.value=e)),X:e.p({options:C.value,title:"选择车辆信息",placeholder:"全部车辆信息",modelValue:I.value}),Y:e.p({span:"12"}),Z:e.p({customStyle:"margin-bottom: 24rpx",gutter:"20rpx"}),aa:e.o(V),ab:e.p({text:"重置","custom-style":{height:"96rpx",color:"var(--sub-color)",borderRadius:"16rpx",fontSize:"30rpx",fontWeight:"bold"}}),ac:e.o(_),ad:e.p({text:"筛选",color:"linear-gradient( 270deg, #31CE57 0%, #07B130 100%)","custom-style":{height:"96rpx",borderRadius:"16rpx",fontSize:"30rpx",fontWeight:"bold"}}),ae:e.sr(r,"348d4abf-2",{k:"filter"}),af:e.o(n),ag:e.p({title:"数据统计筛选",height:"550"}),ah:e.sr("datetimePicker","348d4abf-28"),ai:e.o(a.confirmDateTime),aj:e.p({mode:"date",confirmColor:"var(--main-color)","min-date":a.minDate,"max-date":a.maxDate})})}};wx.createComponent(o);
