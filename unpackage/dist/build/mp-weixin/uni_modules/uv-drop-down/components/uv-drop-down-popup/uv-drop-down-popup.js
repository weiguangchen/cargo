"use strict";const t=require("../../../../common/vendor.js"),e=require("../../../uv-ui-tools/libs/mixin/mpMixin.js"),i=require("../../../uv-ui-tools/libs/mixin/mixin.js"),r={name:"uv-drop-down-popup",mixins:[e.mpMixin,i.mixin],props:{sign:{type:[String,Number],default:"UVDROPDOWN"},zIndex:{type:[Number,String],default:999},opacity:{type:[Number,String],default:.5},clickOverlayOnClose:{type:Boolean,default:!0},currentDropItem:{type:Object,default:()=>({activeIndex:0,child:[]})},keyName:{type:String,default:"label"}},data:()=>({show:!1,rect:{},height:0}),computed:{overlayStyle(){let{height:t=0,top:e=0}=this.rect;const i={position:"fixed",top:`${e+t}px`,left:0,right:0,zIndex:this.zIndex,bottom:0,"background-color":`rgba(0, 0, 0, ${this.opacity})`};return this.$uv.deepMerge(i,this.$uv.addStyle(this.customStyle))},list(){try{return Array.isArray(this.currentDropItem.child)?this.currentDropItem.child:[]}catch(t){return[]}},getTextColor(t){return t=>{const e=this.currentDropItem.activeIndex==t,i=this.currentDropItem.color,r=this.currentDropItem.activeColor;return e?r||"#3c9cff":i||"#333"}},getTextSize(t){return t=>{const e=this.currentDropItem.activeIndex==t,i=this.currentDropItem.size,r=this.currentDropItem.activeSize;return e?r||"30rpx":i||"30rpx"}},itemCustomStyle(){return t=>{const e={};return this.currentDropItem.activeIndex==t&&this.currentDropItem.itemActiveCustomStyle?this.$uv.deepMerge(e,this.$uv.addStyle(this.currentDropItem.itemActiveCustomStyle)):this.currentDropItem.itemCustomStyle?this.$uv.deepMerge(e,this.$uv.addStyle(this.currentDropItem.itemCustomStyle)):e}}},created(){this.init()},methods:{blockClick(){},clickHandler(t,e){this.currentDropItem.activeIndex=e,this.$emit("clickItem",t),this.close()},init(){t.index.$off(`${this.sign}_GETRECT`),t.index.$on(`${this.sign}_GETRECT`,(t=>{this.rect=t})),t.index.$off(`${this.sign}_CLICKMENU`),t.index.$on(`${this.sign}_CLICKMENU`,(async t=>{t.show?this.open():this.close()}))},open(){this.show=!0,this.$nextTick((async()=>{const t=await this.queryRect();this.height=t.height,this.$emit("popupChange",{show:!0})}))},close(){this.show&&(this.height=0,this.height=0,this.show=!1,t.index.$emit(`${this.sign}_CLOSEPOPUP`),this.$emit("popupChange",{show:!1}))},clickOverlay(){this.clickOverlayOnClose&&this.close()},queryRect(){return new Promise((t=>{this.$uvGetRect(".uv-dp__container__list").then((e=>{t(e)}))}))},animation(t,e=200){}}};if(!Array){(t.resolveComponent("uv-text")+t.resolveComponent("uv-transition"))()}Math||((()=>"../../../uv-text/components/uv-text/uv-text.js")+(()=>"../../../uv-transition/components/uv-transition/uv-transition.js"))();const o=t._export_sfc(r,[["render",function(e,i,r,o,s,n){return{a:t.f(n.list,((e,i,o)=>({a:"6046ae38-1-"+o+",6046ae38-0",b:t.p({text:e[r.keyName],size:n.getTextSize(i),color:n.getTextColor(i)}),c:i,d:t.o((t=>n.clickHandler(e,i)),i),e:t.s(n.itemCustomStyle(i))}))),b:`${s.height}px`,c:t.o(((...t)=>n.blockClick&&n.blockClick(...t))),d:t.o(n.clickOverlay),e:t.p({show:s.show,mode:"fade",duration:300,"custom-style":n.overlayStyle})}}],["__scopeId","data-v-6046ae38"]]);wx.createComponent(o);
